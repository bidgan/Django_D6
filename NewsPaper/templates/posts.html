{% extends 'flatpages/default.html' %}
{% load news_filters %}

{% block title %}
Posts
{% endblock title %}

{% block content %}
<style>
    .post-list {
        list-style: none;
        padding: 0;
    }
    .post {
        border-bottom: 1px solid #ddd;
        padding: 10px 0;
        margin-bottom: 15px;
    }
    .post:last-child {
        border-bottom: none;
    }
    .post-title {
        font-size: 1.5em;
        margin-bottom: .5em;
    }
    .post-meta {
        font-size: .85em;
        color: #666;
    }
    .post-content {
        margin-bottom: 1em;
    }
    .post-category {
        font-style: italic;
        margin-bottom: .5em;
    }
    .post-author {
        margin-top: 1em;
    }
</style>

<h1>Все новости</h1>
<h3>{{ time_now|date:'M d Y' }}</h3>
<hr>

{% if posts %}
    <ul class="post-list">
        {% for post in posts %}
            <li class="post">
                <div class="post-category">
                    Категории:
                    {% for category in post.categories.all %}
                        {{ category.name }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </div>
                <div class="post-title">{{ post.title|truncatechars:50|censor }}</div>
                <div class="post-content">{{ post.content|truncatechars:20|censor }}</div>
                <div class="post-meta post-author">
                    <span>Автор: {{ post.author.user.username }}</span> |
                    <span>Дата: {{ post.created_at|date:"d.m.Y H:i" }}</span> |
                    <span>Рейтинг: {{ post.rating }}</span>
                </div>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <h2>Новостей нет!</h2>
{% endif %}
{% endblock content %}